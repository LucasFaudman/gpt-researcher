---
title: MCP Retriever
description: Integrate Model Context Protocol (MCP) servers with GPT Researcher
---

# Model Context Protocol (MCP) Retriever

The MCP Retriever allows GPT Researcher to access data from [Model Context Protocol](https://modelcontextprotocol.io/) servers, which provide a standardized way to expose tools, resources, and prompts to AI systems.

## What is Model Context Protocol?

MCP is an open standard developed by Anthropic for connecting AI systems with data sources and tools. It provides a unified protocol for:

- Accessing contextual information through **resources**
- Executing commands through **tools**
- Using predefined templates through **prompts**

MCP solves the "N times M problem" where numerous AI applications need to access various data sources and tools.

## Installation

The MCP retriever requires the `mcp` Python package:

```bash
pip install "mcp>=1.0.0"
```

## Usage

### Basic Configuration

To use an MCP server as a data source, set `RETRIEVER=mcp` in your environment variables or specify it when creating a GPT Researcher instance:

```python
from gpt_researcher import GPTResearcher

researcher = GPTResearcher(
    query="your query",
    report_type="research_report",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "python",
        "mcp_server_args": "-m my_mcp_server",
        # ... other MCP configuration
    }
)
```

### Via Command Line

```bash
python -m gpt_researcher.main \
  --query "your query" \
  --retriever mcp \
  --mcp_server_command "python" \
  --mcp_server_args "-m my_mcp_server" \
  --mcp_tool_name "search"
```

## Remote vs Local MCP Servers

MCP servers can run either locally or remotely:

### Local MCP Servers

Local servers run on your machine and are started by GPT Researcher:

```python
researcher = GPTResearcher(
    query="your query",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "python",  # Local command to execute
        "mcp_server_args": "path/to/your_server.py",
        "mcp_tool_name": "search"
    }
)
```

### Remote MCP Servers

Remote servers run on different machines or cloud services. For these, you typically use a connector:

```python
researcher = GPTResearcher(
    query="your query",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "npx",
        "mcp_server_args": "-y @modelcontextprotocol/server-connector https://your-remote-mcp-server.com",
        "mcp_env_AUTH_TOKEN": "your_auth_token",  # If authentication is required
        "mcp_tool_name": "search"
    }
)
```

Alternatively, for cloud-hosted MCP servers that provide CLI tools:

```python
researcher = GPTResearcher(
    query="your query",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "mcp-cloud-client",
        "mcp_server_args": "connect --server-id abc123",
        "mcp_tool_name": "search"
    }
)
```

## Configuration Options

The MCP Retriever accepts the following configuration parameters through headers or environment variables:

| Parameter | Description | Example |
|-----------|-------------|---------|
| `mcp_server_name` | Name of the MCP server | `"github"` |
| `mcp_server_command` | Command to start the MCP server | `"python"` |
| `mcp_server_args` | Arguments for the server command | `"-m my_mcp_server"` |
| `mcp_resource_uri` | URI template for accessing a resource | `"file://{query}"` |
| `mcp_tool_name` | Name of the MCP tool to invoke | `"search"` |
| `mcp_tool_arg_*` | Arguments for the tool (prefix with `mcp_tool_arg_`) | `"mcp_tool_arg_query=..."` |
| `mcp_env_*` | Environment variables (prefix with `mcp_env_`) | `"mcp_env_API_KEY=..."` |

## Integration Examples

### GitHub Search

Use the GitHub MCP server to research code repositories:

```python
from gpt_researcher import GPTResearcher

researcher = GPTResearcher(
    query="How to implement React hooks",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "npx",
        "mcp_server_args": "-y @modelcontextprotocol/server-github",
        "mcp_env_GITHUB_TOKEN": "your_github_token",
        "mcp_tool_name": "searchCode",
        "mcp_tool_arg_query": "useState in:file language:javascript",
        "mcp_tool_arg_maxResults": "5"
    }
)

# Run the research
context = await researcher.conduct_research()
report = await researcher.write_report()
```

### Tavily Search

Use the Tavily Search MCP server to perform web searches:

```python
researcher = GPTResearcher(
    query="Latest advancements in fusion energy",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "npx",
        "mcp_server_args": "-y tavily-mcp",
        "mcp_env_TAVILY_API_KEY": "your_tavily_api_key",
        "mcp_tool_name": "search",
        "mcp_tool_arg_query": "{query}",  # Uses the research query
        "mcp_tool_arg_max_results": "10"
    }
)
```

Tavily MCP supports additional search parameters:

- `search_depth`: Set to "basic" (faster results) or "advanced" (more comprehensive)
- `include_domains`: Comma-separated list of domains to include
- `exclude_domains`: Comma-separated list of domains to exclude
- `search_mode`: Options include "text," "news," and "semantic" (default)

You can get a Tavily API key at [tavily.com](https://tavily.com).

### PostgreSQL Database

Query a PostgreSQL database for information:

```python
researcher = GPTResearcher(
    query="Sales trends in Q1 2024",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "npx",
        "mcp_server_args": "-y @modelcontextprotocol/server-postgres",
        "mcp_env_POSTGRES_CONNECTION_STRING": "postgresql://user:pass@host:port/db",
        "mcp_resource_uri": "schema://sales",  # Get schema information
        "mcp_tool_name": "query",
        "mcp_tool_arg_sql": "SELECT * FROM sales WHERE quarter='Q1' AND year=2024"
    }
)
```

### Cloud-based MCP Servers

Connect to specialized cloud MCP servers:

```python
researcher = GPTResearcher(
    query="Analyze this company's financial data",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "npx",
        "mcp_server_args": "-y @modelcontextprotocol/server-connector https://finance-mcp.example.com",
        "mcp_env_API_KEY": "your_api_key",
        "mcp_tool_name": "analyzeFinancials",
        "mcp_tool_arg_company": "AAPL",
        "mcp_tool_arg_period": "Q2_2024"
    }
)
```

## Popular MCP Server Examples from Awesome-MCP-Servers

Here are examples using popular servers from the [awesome-mcp-servers](https://github.com/punkpeye/awesome-mcp-servers) collection:

### Atlassian (Confluence/Jira)

```python
researcher = GPTResearcher(
    query="Project roadmap for Q3",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "python",
        "mcp_server_args": "-m mcp_atlassian",
        "mcp_env_ATLASSIAN_API_TOKEN": "your_api_token",
        "mcp_env_ATLASSIAN_EMAIL": "your_email",
        "mcp_env_ATLASSIAN_URL": "https://your-company.atlassian.net",
        "mcp_tool_name": "searchJira",
        "mcp_tool_arg_jql": "project = 'CORE' AND sprint in openSprints()"
    }
)
```

### Web3/Blockchain

```python
researcher = GPTResearcher(
    query="Ethereum transaction analysis",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "python",
        "mcp_server_args": "-m web3_mcp",
        "mcp_env_ANKR_API_KEY": "your_ankr_api_key",
        "mcp_tool_name": "getTransactionHistory",
        "mcp_tool_arg_address": "0x1234...5678",
        "mcp_tool_arg_chain": "ethereum"
    }
)
```

### HomeAssistant

```python
researcher = GPTResearcher(
    query="Smart home energy usage patterns",
    headers={
        "retriever": "mcp",
        "mcp_server_command": "npx",
        "mcp_server_args": "-y homeassistant-mcp",
        "mcp_env_HOMEASSISTANT_URL": "http://homeassistant.local:8123",
        "mcp_env_HOMEASSISTANT_TOKEN": "your_long_lived_token",
        "mcp_tool_name": "getEnergyData",
        "mcp_tool_arg_period": "month"
    }
)
```

## Using Multiple Retrievers

You can use MCP alongside other retrievers:

```python
researcher = GPTResearcher(
    query="Impact of AI on healthcare",
    headers={
        "retrievers": "mcp,tavily",  # Use both MCP and Tavily
        # MCP configuration
        "mcp_server_command": "npx",
        "mcp_server_args": "-y @modelcontextprotocol/server-brave-search",
        "mcp_tool_name": "search"
    }
)
```

## Available MCP Servers

There's a vast ecosystem of MCP servers available. Check the [awesome-mcp-servers](https://github.com/punkpeye/awesome-mcp-servers) repository for a comprehensive list, which includes:

- **API Integrations**: GitHub, Slack, Spotify, Notion, Asana
- **Data Sources**: PostgreSQL, SQLite, MongoDB, Elasticsearch
- **Web Services**: Brave Search, Perplexity, HuggingFace Spaces
- **Developer Tools**: Git, VSCode, Terminal control
- **IoT/Smart Home**: HomeAssistant, Oura Ring
- **Finance/Blockchain**: Strava, Web3
- **Productivity**: Google Drive, Apple Notes, Obsidian

For a full list, visit [awesome-mcp-servers](https://github.com/punkpeye/awesome-mcp-servers).

## Creating Custom MCP Servers

You can create your own MCP servers to integrate with GPT Researcher:

```python
from mcp.server.fastmcp import FastMCP

# Create an MCP server
mcp = FastMCP("MyCustomServer")

# Add a search tool
@mcp.tool()
def search(query: str, max_results: int = 10) -> list:
    """Search for information based on the query"""
    # Implement your custom search logic
    results = []
    # ... your search logic
    return [
        {"href": "url1", "body": "content1"},
        {"href": "url2", "body": "content2"},
    ]

# Run the server
if __name__ == "__main__":
    mcp.run()
```

## References

- [MCP Documentation](https://modelcontextprotocol.io/)
- [MCP Python SDK](https://github.com/modelcontextprotocol/python-sdk)
- [Awesome MCP Servers](https://github.com/punkpeye/awesome-mcp-servers) 