<!DOCTYPE html>
<html lang="en">

<head>
    <title>ResearchGPT</title>
    <meta name="description" content="A research assistant powered by GPT-4">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="../static/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">


    <style>
        @keyframes gradientBG {
            0% {background-position: 0% 50%;}
            50% {background-position: 100% 50%;}
            100% {background-position: 0% 50%;}
        }

        body {
            font-family: 'Montserrat', sans-serif;
            color: #fff;
            line-height: 1.6;
            background-size: 200% 200%;
            background-image: linear-gradient(45deg, #151A2D, #2D284D, #151A2D);
            animation: gradientBG 10s ease infinite;
        }

        .landing {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
        }

        .landing h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 2rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, .5);
        }

        .landing p {
            font-size: 1.5rem;
            font-weight: 400;
            max-width: 500px;
            margin: auto;
            margin-bottom: 2rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, .3);
        }

        .container {
            max-width: 900px;
            margin: auto;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            box-shadow: 0px 10px 25px rgba(0, 0, 0, 0.1);
            transition: all .3s ease-in-out;
            margin-bottom: 180px;
        }

        .container:hover {
            transform: scale(1.01);
            box-shadow: 0px 15px 30px rgba(0, 0, 0, 0.2);
        }

        textarea, select, #output, #reportContainer {
            background-color: rgba(255,255,255,0.1);
            border: none;
            color: #fff;
            transition: all .3s ease-in-out;
        }

        textarea:hover, textarea:focus, select:hover, select:focus {
            background-color: rgba(248, 248, 248, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease-in-out;
        }

        .btn-primary {
            background: linear-gradient(to right, #0062cc, #007bff);
            border: none;
            transition: all .3s ease-in-out;
        }

        .btn-secondary {
            background: linear-gradient(to right, #6c757d, #6c757d);
            border: none;
            transition: all .3s ease-in-out;
        }

        .btn:hover {
            opacity: 0.8;
            transform: scale(1.1);
            box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.3);
        }

        footer {
            position: fixed;
            left: 0;
            bottom: 0;
            width: 100%;
            background: linear-gradient(to right, #151A2D, #111827);
            color: white;
            text-align: center;
            padding: 10px 0;
        }
        .margin-div {
            margin-top: 20px;
            margin-bottom: 20px;
            padding: 10px;
        }

         #output {
            height: 100px;
            overflow: auto;
            padding: 10px;
             margin-bottom: 10px;
             margin-top: 10px;
        }
        #reportContainer {
            background-color: rgba(255,255,255,0.1);
            border: none;
            color: #fff;
            transition: all .3s ease-in-out;
            padding: 10px;
            border-radius: 12px;

    }

    </style>
</head>
<body>

<section class="landing">
    <div class="max-w-5xl mx-auto text-center">
        <h1 class="text-4xl font-extrabold mx-auto lg:text-7xl">
            Say Goodbye to <br>
            <span style="background-image:linear-gradient(to right, #9867F0, #ED4E50); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Hours of Research</span>
        </h1>
        <p class="max-w-5xl mx-auto text-gray-600 mt-8" style="font-size:20px">
            Say Hello to ResearchGPT, your AI mate for rapid insights and comprehensive research. ResearchGPT takes care of everything from accurate source gathering to organization of research results - all in one platform designed to make your research process a breeze.
        </p>
        <a href="#form" class="btn btn-primary">Get Started</a>
    </div>
</section>

    <main class="container" id="form">
        <form method="POST" class="mt-5" onsubmit="startResearch(); return false;">
            <div class="form-group">
                <label for="task">What would you like me to research next?</label>
                <textarea name="task" rows="3" class="form-control" required></textarea>
            </div>
            <div class="form-group">
                <label for="report_type">What type of report would you like me to generate?</label>
                <select name="report_type" class="form-control" required>
                    <option value="research_report">Research Report</option>
                    <option value="resource_report">Resource Report</option>
                    <option value="outline_report">Outline Report</option>
                </select>
            </div>
            <input type="submit" value="Research" class="btn btn-primary button-padding">
        </form>

        <div class="margin-div">
            <h2>Agent Output</h2>
            <div id="output"></div>
        </div>
        <div class="margin-div">
            <h2>Research Report</h2>
            <div id="reportContainer"></div>
            <button onclick="copyToClipboard()" class="btn btn-secondary mt-3">Copy to clipboard</button>
            <a id="downloadLink" href="#" class="btn btn-secondary mt-3" target="_blank">Download as PDF</a>
        </div>
    </main>

    <footer>
        <p>ResearchGPT &copy; 2023</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.9.1/showdown.min.js"></script>
    <script>
        function copyToClipboard() {
            var textarea = document.createElement('textarea');
            textarea.id = 'temp_element';
            textarea.style.height = 0;
            document.body.appendChild(textarea);
            textarea.value = document.getElementById('reportContainer').innerText;
            var selector = document.querySelector('#temp_element');
            selector.select();
            document.execCommand('copy');
            // Remove the <textarea> element
            document.body.removeChild(textarea);
        }

function startResearch() {
    // Clear output and reportContainer divs
    document.getElementById("output").innerHTML = "";
    document.getElementById("reportContainer").innerHTML = "";

    const converter = new showdown.Converter();
    const socket = new WebSocket("ws://localhost:8000/ws");
    socket.onmessage = function(event) {
        console.log(event.data);
        const data = JSON.parse(event.data);
        if (data.type === 'logs') {
            // Append the agent output to the output section
            const output = document.getElementById("output");
            output.innerHTML += "<br>"+data.output+"<br>";
            output.scrollTop = output.scrollHeight;  // Scroll to the bottom of the output
            output.style.display = "block";
        } else if (data.type === 'report') {
            // Update the report section with new data
            const reportContainer = document.getElementById("reportContainer");
            const markdownOutput = converter.makeHtml(data.output);
            reportContainer.innerHTML += markdownOutput;
            updateScroll();
        } else if (data.type === 'path') {
            // Update the download link with the received path
            const path = data.output;
            const downloadLink = document.getElementById("downloadLink");
            downloadLink.href = path;
        }
    };
    socket.onopen = function (event) {
        let task = document.querySelector('textarea[name="task"]').value;
        let report_type = document.querySelector('select[name="report_type"]').value;
        let data = "start " + JSON.stringify({task: task, report_type: report_type});
        socket.send(data);
    };
    function updateScroll() {
        window.scrollTo(0,document.body.scrollHeight);
    }
}

    </script>

</body>
</html>
